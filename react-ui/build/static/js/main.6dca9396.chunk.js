(this.webpackJsonpcapodannocon=this.webpackJsonpcapodannocon||[]).push([[0],{129:function(e,t,n){},131:function(e,t,n){},139:function(e,t){},141:function(e,t){},151:function(e,t){},153:function(e,t){},178:function(e,t){},180:function(e,t){},181:function(e,t){},186:function(e,t){},188:function(e,t){},207:function(e,t){},219:function(e,t){},222:function(e,t){},243:function(e,t,n){"use strict";n.r(t);var r=n(1),s=n.n(r),i=n(121),c=n.n(i),a=(n(129),n(130),n(6)),o=n(7),l=n(9),u=n(8),j=(n(131),n(5)),d=n.n(j),b=n(11),h=n(133),m="http://localhost:3001/",p=function(){var e=Object(b.a)(d.a.mark((function e(t){var n,r,s=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:"",r=s.length>2&&void 0!==s[2]?s[2]:{},e.abrupt("return",fetch(t,r).then((function(e){if(e.ok)return e.json();throw new Error(n)})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e="".concat(m,"users");return console.log(e),p(e,"Errore durante il download dei dati")},v=function(){var e=Object(b.a)(d.a.mark((function e(t){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.genSalt(6);case 2:return n=e.sent,r=h.hashSync(t,n),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(b.a)(d.a.mark((function e(t,n){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=h.compareSync(t,n),e.abrupt("return",r);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),x=function(e){var t={method:"POST",headers:{"Content-type":"application/json",Accept:"application/json"},body:{user:JSON.stringify(e)}};return p("".concat(m,"users"),"errore nel collegamento al server",t)},g=function(e){var t={method:"PUT",headers:{"Content-type":"application/json",Accept:"application/json"},body:JSON.stringify(e)};return p("".concat(m,"users/").concat(e.id),"Errore nel collegamento al server",t)},S=function(e){var t={method:"PUT",headers:{"Content-type":"application/json",Accept:"application/json"},body:JSON.stringify(e)};return p("".concat(m,"events/").concat(e.id),"Errore nel collegamento al server",t)},y=function(e){var t="".concat(m,"events/").concat(e);return p(t,"Impossibile cancellare l'elemento dal server",{method:"DELETE",headers:{"Content-type":"application/json",Accept:"application/json"}})},_=n(244),w=n(69),k=n(3),N=n(23),C=n.n(N),D=n(0);Object(w.b)("user_lLGwhhli0BQUl5nTAduzL");var F=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).state={hashedPass:!1,users:[],error:"",emailSent:!1,userAlert:!1},r._isMounted=!1,r}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this._isMounted=!0}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"handleSubmit",value:function(){var e=Object(b.a)(d.a.mark((function e(t){var n,r,s=this;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n=t.target.login_username.value,r=t.target.login_password.value,O().then((function(e){return s.setState({users:e})})).then((function(){var e=s.state.users.filter((function(e){return e.username===n}));0===e.length?s._isMounted&&s.setState({error:"Username non valido"}):f(r,e[0].password).then((function(t){t?s.props.log({logStatus:!0,user:e[0]}):s._isMounted&&s.setState({error:"Password errata"})})).then((function(e){return s._isMounted&&s.setState({users:[]})}))}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendEmail",value:function(){var e=Object(b.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={username:t.username,email:t.email,sitename:"CapodannoCON",verify_url:"/verify/".concat(t.email_verified)},w.a.send("service_6om229g","template_dy4gloo",n);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"register",value:function(){var e=Object(b.a)(d.a.mark((function e(t){var n,r,s,i,c,a=this;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n=t.target,r=n.register_username,s=n.register_password,i=n.register_email,c={id:Object(_.a)(),username:r.value,password:s.value,email:i.value,role:1,email_verified:Object(_.a)(),created_at:new Date,updated_at:new Date},O().then((function(e){0===e.filter((function(e){return e.username===c.username||e.email===c.email})).length?v(s.value).then((function(e){return a.setState({hashedPass:e})})).then((function(){var e={id:Object(_.a)(),username:r.value,password:a.state.hashedPass,email:i.value,role:1,email_verified:Object(_.a)(),created_at:new Date,updated_at:new Date};x(e).then((function(){return a.sendEmail(e)})).then((function(){return a.setState({emailSent:!0})}))})):a.setState({userAlert:!0})}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state.error,n=this.props,r=n.title;return n.logStatus?Object(D.jsx)(k.a,{to:"/"}):Object(D.jsxs)("div",{className:"login-register",children:[Object(D.jsxs)("div",{className:"container form-wrapper",children:[Object(D.jsx)("img",{src:"logo.png",alt:"capodannocon"}),Object(D.jsx)("h3",{children:r}),Object(D.jsxs)("form",{id:"login",className:"login",onSubmit:function(t){return e.handleSubmit(t)},children:[Object(D.jsx)("h4",{children:"Effettua l'accesso..."}),Object(D.jsxs)("div",{className:"form-row",children:[Object(D.jsx)("label",{htmlFor:"login_username",children:Object(D.jsx)("strong",{children:"Username"})}),Object(D.jsx)("input",{type:"text",id:"login_username",required:!0})]}),Object(D.jsxs)("div",{className:"form-row",children:[Object(D.jsx)("label",{htmlFor:"login-password",children:Object(D.jsx)("strong",{children:"Password"})}),Object(D.jsx)("input",{type:"password",id:"login_password",required:!0})]}),t,Object(D.jsx)("button",{className:"btn btn-primary",type:"submit",children:"Login"})]}),Object(D.jsxs)("form",{id:"register",className:"register",onSubmit:function(t){return e.register(t)},children:[Object(D.jsx)("h4",{children:"...oppure registrati"}),Object(D.jsxs)("div",{className:"form-row",children:[Object(D.jsx)("label",{htmlFor:"register_username",children:Object(D.jsx)("strong",{children:"Username"})}),Object(D.jsx)("input",{type:"text",id:"register_username",required:!0})]}),Object(D.jsxs)("div",{className:"form-row",children:[Object(D.jsx)("label",{htmlFor:"register_email",children:Object(D.jsx)("strong",{children:"Email"})}),Object(D.jsx)("input",{type:"email",id:"register_email",required:!0})]}),Object(D.jsxs)("div",{className:"form-row",children:[Object(D.jsx)("label",{htmlFor:"register_password",children:Object(D.jsx)("strong",{children:"Password"})}),Object(D.jsx)("input",{type:"password",id:"register_password",required:!0})]}),Object(D.jsx)("button",{className:"btn btn-primary",type:"submit",children:"Register"})]})]}),Object(D.jsx)(C.a,{show:this.state.emailSent,showConfirm:!0,confirmBtnText:"Ok",title:"Successo!",onConfirm:function(){return e.setState({emailSent:!e.state.emailSent})},children:Object(D.jsx)("p",{children:"La tua registrazione \xe8 avvenuta con successo. Controlla la tua email e segui le istruzioni per verificare il tuo account."})}),Object(D.jsx)(C.a,{show:this.state.userAlert,showConfirm:!0,confirmBtnText:"Ok",title:"Attenzione!",onConfirm:function(){return e.setState({userAlert:!1})},children:Object(D.jsx)("p",{children:"Questo utente risulta gi\xe0 registrato."})})]})}}]),n}(r.Component),E=function(e){return g(e)},U=function(e){return function(e){return p("".concat(m,"users/").concat(e),"Errore nel collegamento al server",{method:"GET",headers:{"Content-type":"application/json",Accept:"application/json"}})}(e)},z=n(122),M=n(22),A=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"logout",value:function(){this.props.log({logStatus:!1})}},{key:"render",value:function(){var e=this;return Object(D.jsx)("header",{id:"mast-head",className:"navbar navbar-nav",children:Object(D.jsxs)("div",{className:"container",children:[Object(D.jsx)("div",{className:"app-logo",children:Object(D.jsx)("img",{src:"logo.png",alt:"capodannocon"})}),Object(D.jsx)("nav",{className:"main-navigation",role:"navigation",children:Object(D.jsx)("ul",{children:Object(D.jsxs)("li",{onClick:function(){return e.logout()},children:["Ciao ",Object(D.jsx)("strong",{children:this.props.user.username}),"! ",Object(D.jsx)("span",{children:"Logout"})]})})})]})})}}]),n}(r.Component),T=n(19),I=n.n(T),P=n(20),L=n(12),q=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).state={item:e.item},r}return Object(o.a)(n,[{key:"handleSubscribe",value:function(){var e=Object(b.a)(d.a.mark((function e(t){var n,r,s,i=this;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.state.item,r=this.props.currentUser,s=Object(L.a)({},n),e.t0=t,e.next="subscribe"===e.t0?6:"unsubscribe"===e.t0?8:10;break;case 6:return s.subscribers.push(r),e.abrupt("break",10);case 8:return s.subscribers=s.subscribers.filter((function(e){return e!==r})),e.abrupt("break",10);case 10:S(s).then((function(){return i.setState({item:s})})).then((function(){return i.props.refresh()}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.currentUser,n=this.state.item;return Object(D.jsxs)("div",{className:"item-detail",children:[Object(D.jsx)("div",{className:"item-image",children:Object(D.jsx)("img",{src:n.image,alt:n.title})}),Object(D.jsx)("div",{className:"item-infos",children:Object(D.jsx)("table",{children:Object(D.jsxs)("tbody",{children:[Object(D.jsx)("tr",{children:Object(D.jsxs)("td",{children:["Titolo: ",n.title]})}),Object(D.jsx)("tr",{children:Object(D.jsxs)("td",{children:["Descrizione: ",n.description]})}),Object(D.jsx)("tr",{children:Object(D.jsxs)("td",{children:["Facilitatore: ",n.created_by]})}),Object(D.jsx)("tr",{children:Object(D.jsxs)("td",{children:["Data: ",new Date(n.date).toLocaleDateString()]})}),Object(D.jsx)("tr",{children:Object(D.jsxs)("td",{children:["Slot: ",n.slot]})}),Object(D.jsx)("tr",{children:Object(D.jsxs)("td",{children:["Min. partecipanti: ",n.min_subscribers]})}),Object(D.jsx)("tr",{children:Object(D.jsxs)("td",{children:["Max. partecipanti: ",n.max_subscribers]})}),Object(D.jsx)("tr",{children:Object(D.jsxs)("td",{children:["Iscritti: ",n.subscribers.join(", ")]})}),Object(D.jsx)("tr",{children:Object(D.jsx)("td",{children:n.subscribers.includes(t)?Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)("span",{children:"Sei iscritto!"})," ",Object(D.jsx)("a",{href:"#",onClick:function(t){return e.handleSubscribe("unsubscribe")},children:"Disiscriviti"})]}):n.subscribers.length===parseInt(n.max_subscribers)?"Numero massimo di iscritti raggiunto":Object(D.jsx)("button",{type:"button",className:"btn btn-primary",onClick:function(){return e.handleSubscribe("subscribe")},children:"Iscriviti"})})})]})})})]})}}]),n}(r.Component),B=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).state={item:e.item,edited:!1,delete:!1},r}return Object(o.a)(n,[{key:"edit",value:function(){var e=Object(b.a)(d.a.mark((function e(t){var n,r=this;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n=this.state.item,S(n).then((function(e){return r.setState({edited:!0})})).then((function(){return r.props.refresh()}));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(b.a)(d.a.mark((function e(){var t,n=this;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.state.item,y(t.id).then((function(){return n.setState({delete:!1})})).then((function(){return n.props.refresh()})).then((function(){return n.props.close()}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state.item;return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsxs)("form",{id:"item-edit",className:"item-edit",children:[Object(D.jsx)("div",{className:"item-image",children:Object(D.jsx)("img",{src:t.image,alt:t.title})}),Object(D.jsx)("div",{className:"item-infos",children:Object(D.jsx)("table",{children:Object(D.jsxs)("tbody",{children:[Object(D.jsx)("tr",{children:Object(D.jsxs)("td",{children:[Object(D.jsx)("label",{htmlFor:"title",children:Object(D.jsx)("strong",{children:"Titolo:"})})," ",Object(D.jsx)("input",{type:"text",id:"title",value:t.title,onChange:function(n){return e.setState({item:Object(L.a)(Object(L.a)({},t),{},{title:n.target.value})})}})]})}),Object(D.jsx)("tr",{children:Object(D.jsxs)("td",{children:[Object(D.jsx)("label",{htmlFor:"description",children:Object(D.jsx)("strong",{children:"Descrizione:"})}),Object(D.jsx)("textarea",{id:"description",rows:"8",value:t.description,onChange:function(n){return e.setState({item:Object(L.a)(Object(L.a)({},t),{},{description:n.target.value})})}})]})}),Object(D.jsx)("tr",{children:Object(D.jsxs)("td",{children:[Object(D.jsx)("label",{htmlFor:"date",children:Object(D.jsx)("strong",{children:"Data:"})}),Object(D.jsxs)("select",{id:"date",onChange:function(n){return e.setState({item:Object(L.a)(Object(L.a)({},t),{},{date:n.target.value})})},value:t.date,children:[Object(D.jsx)("option",{value:"null",children:"Seleziona una"}),Object(D.jsx)("option",{value:"2021-12-29",children:"29 Dicembre"}),Object(D.jsx)("option",{value:"2021-12-30",children:"30 Dicembre"}),Object(D.jsx)("option",{value:"2021-12-31",children:"31 Dicembre"}),Object(D.jsx)("option",{value:"2022-01-01",children:"1 Gennaio"})]})]})}),Object(D.jsx)("tr",{children:Object(D.jsxs)("td",{children:[Object(D.jsx)("label",{htmlFor:"slot",children:Object(D.jsx)("strong",{children:"Slot:"})}),Object(D.jsxs)("select",{id:"slot",value:t.slot,onChange:function(n){return e.setState({item:Object(L.a)(Object(L.a)({},t),{},{slot:n.target.value})})},children:[Object(D.jsx)("option",{value:"null",children:"Seleziona uno"}),Object(D.jsx)("option",{value:"diurno",children:"Diurno (10-15)"}),Object(D.jsx)("option",{value:"pomeridiano",children:"Pomeridiano (15-20)"}),Object(D.jsx)("option",{value:"serale",children:"Serale (21 in poi)"})]})]})}),Object(D.jsx)("tr",{children:Object(D.jsxs)("td",{children:[Object(D.jsx)("label",{htmlFor:"min_subscribers",children:Object(D.jsx)("strong",{children:"Min. partecipanti:"})}),Object(D.jsx)("input",{type:"number",id:"min_subscribers",value:t.min_subscribers,onChange:function(n){return e.setState({item:Object(L.a)(Object(L.a)({},t),{},{min_subscribers:n.target.value})})}})]})}),Object(D.jsx)("tr",{children:Object(D.jsxs)("td",{children:[Object(D.jsx)("label",{htmlFor:"max_subscribers",children:Object(D.jsx)("strong",{children:"Max. partecipanti:"})}),Object(D.jsx)("input",{type:"number",id:"max_subscribers",value:t.max_subscribers,onChange:function(n){return e.setState({item:Object(L.a)(Object(L.a)({},t),{},{max_subscribers:n.target.value})})}})]})}),Object(D.jsx)("tr",{children:Object(D.jsxs)("td",{children:[Object(D.jsx)("strong",{children:"Iscritti:"})," ",t.subscribers.join(", ")]})}),Object(D.jsxs)("tr",{className:"actions",children:[Object(D.jsx)("td",{children:Object(D.jsxs)("button",{type:"button",className:"btn btn-success",onClick:function(t){return e.edit(t)},children:[Object(D.jsx)(I.a,{path:P.f,size:"15px"})," Salva modifiche"]})}),Object(D.jsx)("td",{children:Object(D.jsxs)("button",{type:"button",className:"btn btn-danger",onClick:function(t){return e.setState({delete:!e.state.delete})},children:[Object(D.jsx)(I.a,{path:P.g,size:"15px"})," Elimina"]})})]})]})})})]}),Object(D.jsx)(C.a,{show:this.state.edited,showConfirm:!0,confirmBtnText:"Ok",title:"Successo!",onConfirm:function(){return e.setState({edited:!e.state.edited})},children:Object(D.jsx)("p",{children:"L'evento \xe8 stato modificato con successo!"})}),Object(D.jsx)(C.a,{show:this.state.delete,showConfirm:!0,showCancel:!0,cancelBtnText:"Annulla",confirmBtnText:"Procedi",title:"Attenzione!",onConfirm:function(){return e.delete()},onCancel:function(){return e.setState({delete:!1})},children:Object(D.jsx)("p",{children:"Stai per eliminare questo evento. Il processo non \xe8 reversibile. Sei sicuro?"})})]})}}]),n}(r.Component),J=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).state={detail:!1},r.handleClick=r.handleClick.bind(Object(M.a)(r)),r}return Object(o.a)(n,[{key:"handleClick",value:function(){this.props.onDelete(this.props.item.id)}},{key:"closeDetail",value:function(){this.setState({detail:!this.state.detail})}},{key:"render",value:function(){var e=this,t=this.props.item,n=t.title,r=t.description,s=t.image,i=t.date,c=t.slot,a=t.created_by,o=t.min_subscribers,l=t.max_subscribers,u=t.subscribers,j=new Date(i).toLocaleDateString("it-IT"),d="diurno"===c?"10-15":"pomeridiano"===c?"15-20":"serale"===c?"21 in poi":"";return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)("li",{className:"list__item",onClick:function(){return e.setState({detail:!0})},children:Object(D.jsxs)("div",{className:"event-card card",children:[Object(D.jsxs)("div",{className:"event-meta",children:[Object(D.jsxs)("span",{className:"date",children:[Object(D.jsx)(I.a,{path:P.c,size:"15px"})," ",j]}),Object(D.jsxs)("span",{className:"slot",children:[Object(D.jsx)(I.a,{path:P.d,size:"15px"})," ",d]}),Object(D.jsxs)("span",{className:"author",children:[Object(D.jsx)(I.a,{path:P.a,size:"15px"})," ",a]})]}),Object(D.jsx)("div",{className:"event-image",children:Object(D.jsx)("img",{src:s,alt:n})}),Object(D.jsxs)("div",{className:"event-info",children:[Object(D.jsx)("h5",{children:n}),Object(D.jsx)("p",{children:r})]}),Object(D.jsxs)("div",{className:"event-footer",children:[Object(D.jsxs)("span",{children:[Object(D.jsx)(I.a,{path:P.b,size:"15px"})," ","".concat(u.length,"/").concat(l)]}),Object(D.jsx)("span",{children:u.length>parseInt(o)?Object(D.jsx)("strong",{children:"Pu\xf2 iniziare!"}):Object(D.jsx)("strong",{children:"Partecipanti insufficienti"})}),Object(D.jsx)("span",{children:u.join(", ")})]})]})}),this.state.detail?Object(D.jsxs)("div",{className:"popup",children:[Object(D.jsx)("button",{type:"button",className:"btn btn-danger close-form",onClick:function(){return e.closeDetail()},children:Object(D.jsx)(I.a,{path:P.e,size:"20px"})}),this.props.user.username===t.created_by?Object(D.jsx)(B,{item:t,close:this.closeDetail.bind(this),refresh:this.props.refresh}):Object(D.jsx)(q,{item:t,currentUser:this.props.user.username,refresh:this.props.refresh})]}):""]})}}]),n}(r.Component),V=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"afterEdit",value:function(){}},{key:"render",value:function(){var e=this,t=this.props.listItems;return t=t.length>0?t.map((function(t){return Object(D.jsx)(J,{onDelete:function(){return e.props.onDelete(t.id)},item:t,user:e.props.user,refresh:e.props.refresh},t.id)})):Object(D.jsxs)("li",{className:"list__empty-list",children:["Lista vuota. ",Object(D.jsx)("br",{})," Aggiungi un nuovo evento"]}),Object(D.jsx)("ul",{className:"list",children:t})}}]),n}(r.Component),G=V,W=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).state={value:"",pristine:!0,dirty:!1,valid:!1,showForm:!1,title:"",description:"",event:!1},r.handleSubmit=r.handleSubmit.bind(Object(M.a)(r)),r}return Object(o.a)(n,[{key:"handleSubmit",value:function(e){e.preventDefault();var t=e.target,n=t.event_title,r=t.event_description,s=t.event_img,i=t.event_subs_min,c=t.event_subs_max,a=t.event_date,o=t.event_slot,l={title:n.value,description:r.value,image:s.value,min:i.value,max:c.value,date:a.value,slot:o.value};this.props.onSubmit({values:l,error:!1}),this.setState({dirty:!1,valid:!1,showForm:!1,event:!0,title:!1,description:!1})}},{key:"render",value:function(){var e=this,t=this.state,n=t.showForm,r=t.event;return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)("button",{type:"button",onClick:function(){return e.setState({showForm:!n})},className:"btn btn-primary add-event",children:"Aggiungi evento"}),n?Object(D.jsxs)("div",{className:"popup",children:[Object(D.jsx)("button",{type:"button",className:"btn btn-danger close-form",onClick:function(){return e.setState({showForm:!n,title:"",description:""})},children:Object(D.jsx)(I.a,{path:P.e,size:"20px"})}),Object(D.jsxs)("form",{onSubmit:this.handleSubmit,className:"event-form",children:[Object(D.jsx)("div",{className:"form-row",children:Object(D.jsxs)("div",{className:"form-col",children:[Object(D.jsx)("label",{htmlFor:"event_title",children:Object(D.jsx)("strong",{children:"Nome evento"})}),Object(D.jsx)("input",{type:"text",id:"event_title",required:!0})]})}),Object(D.jsx)("div",{className:"form-row",children:Object(D.jsxs)("div",{className:"form-col",children:[Object(D.jsx)("label",{htmlFor:"event_description",children:Object(D.jsx)("strong",{children:"Descrizione evento"})}),Object(D.jsx)("textarea",{type:"text",id:"event_description"})]})}),Object(D.jsx)("div",{className:"form-row",children:Object(D.jsxs)("div",{className:"form-col",children:[Object(D.jsx)("label",{htmlFor:"event_img",children:Object(D.jsx)("strong",{children:"Immagine (incolla un url immagine)"})}),Object(D.jsx)("input",{type:"text",id:"event_img",required:!0})]})}),Object(D.jsxs)("div",{className:"form-row",children:[Object(D.jsxs)("div",{className:"form-col half",children:[Object(D.jsx)("label",{htmlFor:"event_subs_min",children:Object(D.jsx)("strong",{children:"Numero partecipanti minimi"})}),Object(D.jsx)("input",{type:"number",id:"event_subs_min",required:!0})]}),Object(D.jsxs)("div",{className:"form-col half",children:[Object(D.jsx)("label",{htmlFor:"event_subs_max",children:Object(D.jsx)("strong",{children:"Numero partecipanti massimi"})}),Object(D.jsx)("input",{type:"number",id:"event_subs_max"})]})]}),Object(D.jsx)("div",{className:"form-row",children:Object(D.jsxs)("div",{className:"form-col",children:[Object(D.jsx)("label",{htmlFor:"event_date",children:Object(D.jsx)("strong",{children:"Data"})}),Object(D.jsxs)("select",{id:"event_date",required:!0,onChange:function(e){return e.target.value},children:[Object(D.jsx)("option",{value:"null",children:"Seleziona una"}),Object(D.jsx)("option",{value:"2021-12-29",children:"29 Dicembre"}),Object(D.jsx)("option",{value:"2021-12-30",children:"30 Dicembre"}),Object(D.jsx)("option",{value:"2021-12-31",children:"31 Dicembre"}),Object(D.jsx)("option",{value:"2022-01-01",children:"1 Gennaio"})]})]})}),Object(D.jsx)("div",{className:"form-row",children:Object(D.jsxs)("div",{className:"form-col",children:[Object(D.jsx)("label",{htmlFor:"event_slot",children:Object(D.jsx)("strong",{children:"Slot"})}),Object(D.jsxs)("select",{id:"event_slot",required:!0,onChange:function(e){return e.target.value},children:[Object(D.jsx)("option",{value:"null",children:"Seleziona uno"}),Object(D.jsx)("option",{value:"diurno",children:"Diurno (10-15)"}),Object(D.jsx)("option",{value:"pomeridiano",children:"Pomeridiano (15-20)"}),Object(D.jsx)("option",{value:"serale",children:"Serale (21 in poi)"})]})]})}),Object(D.jsx)("button",{type:"submit",className:"btn btn-success",children:"Aggiungi evento"})]})]}):"",Object(D.jsx)(C.a,{show:r,showConfirm:!0,confirmBtnText:"Ok",title:"Successo!",onConfirm:function(){return e.setState({event:!r})},children:Object(D.jsx)("p",{children:"L'evento \xe8 stato aggiunto con successo!"})})]})}}]),n}(r.Component),Q=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).state={events:[],error:""},r.handleSubmit=r.handleSubmit.bind(Object(M.a)(r)),r.handleDelete=r.handleDelete.bind(Object(M.a)(r)),r.handleError=r.handleError.bind(Object(M.a)(r)),r._isMounted=!1,r}return Object(o.a)(n,[{key:"handleSubmit",value:function(e){if(!1===e.error){var t=e.values,n=t.title,r=t.description,s=t.image,i=t.min,c=t.max,a=t.date,o=t.slot,l={id:Object(_.a)(),title:n,description:r,image:s,date:a,slot:o,min_subscribers:i,max_subscribers:c,subscribers:[],created_by:this.props.user.username,created_at:new Date,updated_at:new Date},u=[].concat(Object(z.a)(this.state.events),[l]);this._isMounted&&this.setState({events:u}),function(e){var t={method:"POST",headers:{"Content-type":"application/json",Accept:"application/json"},body:JSON.stringify(e)};return p("".concat(m,"events"),"Errore nel collegamento col server",t)}(l).catch(this.handleError)}}},{key:"handleDelete",value:function(e){var t=this.state.events;t=t.filter((function(t){return t.id!==e})),this.setState({events:t}),y(e).catch(this.handleError)}},{key:"handleError",value:function(e){var t=this;this.setState({error:"Error: ".concat(e.message)},(function(){return setTimeout((function(){return t.setState({error:""})}),3e3)}))}},{key:"componentDidMount",value:function(){this._isMounted=!0,this._isMounted&&this.get()}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"get",value:function(){var e=Object(b.a)(d.a.mark((function e(){var t,n=this;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=function(e,t){var n=new Date(e.date).toLocaleDateString(),r=new Date(t.date).toLocaleDateString();return n<r?-1:n>r?1:0},p("".concat(m,"events"),"Errore durante il download dei dati").then((function(e){var r=e.sort(t);n.setState({events:r})})).catch(this.handleError);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.props.logStatus?Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(A,{log:this.props.log.bind(this),user:this.props.user}),Object(D.jsxs)("div",{className:"container",children:[Object(D.jsx)(W,{onSubmit:this.handleSubmit}),Object(D.jsx)(G,{onDelete:this.handleDelete,listItems:this.state.events,user:this.props.user,refresh:this.get.bind(this)})]})]}):Object(D.jsx)(k.a,{to:"/login"})}}]),n}(r.Component),R=n(123),Y=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).state={users:[],pathname:window.location.pathname.replace("/verify/",""),verified:!1,error:!1},r}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.state.pathname;O().then((function(t){return!e.state.verified&&e.setState({users:t})})).then((function(){var n=e.state.users.filter((function(e){return e.email_verified===t}));n.length>0&&((n=n[0]).logStatus=!0,n.email_verified=!0,function(e){var t={method:"PUT",headers:{"Content-type":"application/json",Accept:"application/json"},body:JSON.stringify(e)};return p("".concat(m,"users/").concat(e.id),"errore nel collegamento al server",t)}(n).then((function(){return e.props.log({logStatus:"verified",user:n})})).then((function(){return e.setState({users:[],verified:!0})})).catch((function(){return e.setState({error:"Provi a fare il furbo?",users:[]})})))}))}},{key:"componentWillUnmount",value:function(){this.state.verified&&this.setState({verified:!1})}},{key:"render",value:function(){var e=this.state,t=e.verified,n=e.error;return t?Object(D.jsx)(k.a,{to:"/"}):n||Object(D.jsx)("p",{children:"Attendi mentre verifichiamo la tua email"})}}]),n}(r.Component),H=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).state={error:"",nextIndex:!1,logStatus:!1,currentUser:{},emailVerified:!1},r}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=localStorage.getItem("currentUser");t&&U(t).then((function(t){return e.setState({currentUser:t,logStatus:t.logStatus})}))}},{key:"log",value:function(e){var t=this,n=e.logStatus,r=e.user;switch(n){case!1:var s=this.state.currentUser;s.logStatus=!1,function(e){g(e)}(s),this.setState({logStatus:!1,currentUser:{}}),localStorage.removeItem("currentUser");break;case!0:r.logStatus=!0,E(r).then((function(){t.setState({logStatus:!0,currentUser:r})})),localStorage.setItem("currentUser",r.id);break;case"verified":r.logStatus=!0,E(r).then((function(){t.setState({logStatus:!0,currentUser:r,emailVerified:!0})})),localStorage.setItem("currentUser",r.id)}}},{key:"render",value:function(){var e=this,t=this.state.logStatus;return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(R.a,{children:Object(D.jsxs)(k.d,{children:[Object(D.jsx)(k.b,{exact:!0,path:"/login",element:Object(D.jsx)(F,{title:"You are not logged in :(",log:this.log.bind(this),logStatus:t})}),Object(D.jsx)(k.b,{exact:!0,path:"/",element:Object(D.jsx)("div",{children:Object(D.jsx)(Q,{log:this.log.bind(this),logStatus:t,user:this.state.currentUser})})}),Object(D.jsx)(k.b,{path:"/verify/*",element:Object(D.jsx)(Y,{log:this.log.bind(this)})})]})}),Object(D.jsx)(C.a,{show:this.state.emailVerified,showConfirm:!0,confirmBtnText:"Ok",title:"Successo!",onConfirm:function(){return e.setState({emailVerified:!e.state.emailVerified})},children:Object(D.jsx)("p",{children:"La tua email \xe8 stata verificata con successo"})})]})}}]),n}(r.Component);c.a.render(Object(D.jsx)(s.a.StrictMode,{children:Object(D.jsx)(H,{})}),document.getElementById("root"))}},[[243,1,2]]]);
//# sourceMappingURL=main.6dca9396.chunk.js.map